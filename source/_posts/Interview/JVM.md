---
title: 面试-JVM篇章

categories: 

- 面试

tags: 

- 面试
date: 2019-10-22 23:30:03
---

### JVM相关面试题

1. JVM运行时数据区分为哪几个部分？分别是什么作用？

   分为程序计数器，**Java虚拟机栈**，本地方法栈，**Java堆**，方法区

   程序计数器：

   程序计数器的工作就是通过改变计数器的值来选取吓一跳需要执行的字节码指令，分支、循环、跳转、异常处理、县城回复等基础功能都依赖程序计数器来完成。Java虚拟机的多线程是**通过线程轮流切换并分配处理器执行时间的方式来实现的**，在任何一个确定的时刻，**一个处理器（一个内核）都只会执行一条线程中的指令**。因此为了线程切换后能恢复到正确的执行位置，每个线程都有一个独立的程序计数器，**互不影响，独立存储，线程私有**，而且是唯一一个没有**OutOfMemoryError**情况的区域。
   
   Java虚拟机栈：
   
   线程私有，生命周期与线程相同，描述的是Java方法执行的内存模型：**每个方法在执行的同事都会创建一个栈帧（Stack Frame）用于存储局部变量表、操作数栈、动态链接、方法出口等信息。每个方法从调用到执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈出栈的过程**。局部变量表**存放了编译期可知的各种基本数据类型（boolean,byte,char,short,int,float,long,double）、对象引用（reference类型，不是对象本身，可能是一个指向对象起始地址的引用指针，也可能是指向一个代表对象的句柄或其他与此对象相关的位置）和returnAddress类型（指向一条字节码指令的地址）**。如果线程请求的栈深度大于虚拟机允许的深度，那么会StackOverflowError，如果扩展时无法申请到足够的内存，则会OutOfMemoryError。
   
   本地方法栈：
   
   为虚拟机使用的Native方法服务。
   
   Java堆：
   
   是Java虚拟机所管理的内存中最大的一块。被所有线程共享，存放对象实例，**所有的对象实例以及数组都在堆上分配**。是是垃圾收集器管理的主要区域，细分可分为**新生代和老年代**，再细分可以有：**Eden空间、From Survivor空间、To Survivor空间。线程共享的Java堆中可能划分出多个线程私有的分配缓冲区（Thread Local Allocation Buffer）**。可以用-Xmx和-Xms来控制大小。无法扩展的时候，会抛出OutOfMemotyError。
   
   方法区：
   
   各个线程共享，存储已经被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。也叫做永久代。
   
   运行时常量池：
   
   是方法取得一部分，Class文件中除了有类的版本、字段、方法、接口等描述信息外，还有一项信息是常量池，用于存放编译器生成的各种字面量和符号引用，这部分内存在类加载后进入方法区的运行时常量池存放。
   
   直接内存：
   
   独立于Java堆和Native堆，收到本机总内存的影响。
   
   
   
   

